@using MvcSample.Web.Models
@model User
@{
    Layout = "/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Home Page";
    string helloClass = null;
}

<div class="jumbotron">
    <h1>ASP.NET</h1>
    <p class="lead">ASP.NET is a free web framework for building great Web sites and Web applications using HTML, CSS and JavaScript.</p>
    <p><a href="http://asp.net" class="btn btn-primary btn-large">Learn more &raquo;</a></p>
</div>
<div class="row">
    <h3 title="@Model.Name" class="@helloClass">Hello @Model.Name!</h3>
</div>

<div style="position: relative; height: 200px; background: lightgray;">
    <div id="DropZone" style="width: 100%; height: 200px; position: absolute;">
        Drop file here
    </div>
</div>

<script>
    function upload(file) {
        var reader = new FileReader();
        var xhr = new XMLHttpRequest();

        xhr.onload = function () {
            console.log(this.responseText);
            document.getElementById('DropZone').innerHTML = this.responseText;
        };

        xhr.open('POST', '/api/pdf2html');
        xhr.overrideMimeType('application/pdf');
        reader.onload = function (e) {
            console.log(e)
            console.log(xhr);
            xhr.send(e.target.result);
        }
        reader.readAsArrayBuffer(file);
    }

    function suppressEvent(e) {
        e.stopPropagation();
        e.preventDefault();
    }

    function drop(e) {
        suppressEvent(e);

        var dt = e.dataTransfer;
        var files = dt.files;
        
        upload(files[0]);
    }

    var zone = document.getElementById('DropZone');
    zone.addEventListener('dragenter', suppressEvent, false);
    zone.addEventListener('dragover', suppressEvent, false);
    zone.addEventListener('drop', drop, false);
</script>
